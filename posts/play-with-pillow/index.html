<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=yandex-verification content="3ccce49727df78e2"><title>Play With Pillow</title><meta name=description content="Focuses on doing some useful stuff using Pillow(Python Image Library ext) for Image Processing. For example Image Cropping, resizing, Pasting image over image etc."><link rel=preload href=/fonts/pt-serif-400-i-latin-ext.woff2 as=font><link rel=preload href=/fonts/pt-sans-400-latin-ext.woff2 as=font><link rel=preload href=/fonts/pt-serif-700-i-latin-ext.woff2 as=font><link rel=preload href=/fonts/pt-serif-700-i-cyrillic.woff2 as=font><link rel=preload href=/fonts/pt-serif-700-cyrillic.woff2 as=font><link rel=preload href=/fonts/pt-serif-400-i-cyrillic.woff2 as=font><link rel=preload href=/fonts/pt-sans-700-cyrillic.woff2 as=font><link rel=preload href=/fonts/pt-serif-700-cyrillic-ext.woff2 as=font><link rel=preload href=/fonts/pt-sans-700-i-latin-ext.woff2 as=font><link rel=preload href=/fonts/pt-sans-700-i-cyrillic.woff2 as=font><link rel=preload href=/fonts/pt-sans-400-i-latin-ext.woff2 as=font><link rel=preload href=/fonts/pt-serif-700-latin.woff2 as=font><link rel=preload href=/fonts/pt-serif-700-i-latin.woff2 as=font><link rel=preload href=/fonts/pt-serif-400-latin.woff2 as=font><link rel=preload href=/fonts/pt-sans-700-latin-ext.woff2 as=font><link rel=preload href=/fonts/pt-sans-400-i-cyrillic.woff2 as=font><link rel=preload href=/fonts/pt-sans-700-cyrillic-ext.woff2 as=font><link rel=preload href=/fonts/pt-sans-400-i-latin.woff2 as=font><link rel=preload href=/fonts/pt-sans-700-latin.woff2 as=font><link rel=preload href=/fonts/pt-sans-400-i-cyrillic-ext.woff2 as=font><link rel=preload href=/fonts/pt-sans-400-cyrillic-ext.woff2 as=font><link rel=preload href=/fonts/pt-serif-400-latin-ext.woff2 as=font><link rel=preload href=/fonts/pt-sans-400-latin.woff2 as=font><link rel=preload href=/fonts/pt-sans-700-i-cyrillic-ext.woff2 as=font><link rel=preload href=/fonts/pt-serif-400-cyrillic-ext.woff2 as=font><link rel=preload href=/fonts/pt-serif-700-latin-ext.woff2 as=font><link rel=preload href=/fonts/pt-serif-400-i-latin.woff2 as=font><link rel=preload href=/fonts/pt-sans-700-i-latin.woff2 as=font><link rel=preload href=/fonts/pt-serif-400-i-cyrillic-ext.woff2 as=font><link rel=preload href=/fonts/pt-sans-400-cyrillic.woff2 as=font><link rel=preload href=/fonts/pt-serif-700-i-cyrillic-ext.woff2 as=font><link rel=preload href=/fonts/pt-serif-400-cyrillic.woff2 as=font><link rel=stylesheet href=https://ruddra.com/css/bundle.min.356507e61d5f59cd5148e0ffd4a39cc1f32f8ed877f19b7fe7eb825bc61d12e0.css integrity="sha256-NWUH5h1fWc1RSOD/1KOcwfMvjth38Zt/5+uCW8YdEuA=" async><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon.png><link rel="shortcut icon" href=/favicon.ico><link rel=alternate type=application/rss+xml title=RSS href=/sitemap.xml><meta name=generator content="Hugo 0.64.0"><meta name=twitter:card content="summary_large_image"><meta name=robots content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="Ruddra.com | Blog by Arnab Kumar Shil"><meta property="article:publisher" content="https://ruddra.com"><meta property="article:section" content="Bulletin"><meta property="article:published_time" content="2017-05-28T00:00:00.00Z"><meta property="article:modified_time" content="2020-01-20T00:00:00.00Z"><meta property="og:updated_time" content="2020-01-20T00:00:00.00Z"><meta property="og:image" content="https://ruddra.com/content/images/2019/08/pillow.jpg"><meta property="og:image:secure_url" content="https://ruddra.com/content/images/2019/08/pillow.jpg"><meta property="og:image:width" content="720"><meta property="og:image:height" content="350"><meta name=twitter:title content="Play With Pillow"><meta name=twitter:description content="Focuses on doing some useful stuff using Pillow(Python Image Library ext) for Image Processing. For example Image Cropping, resizing, Pasting image over image etc."><meta property="og:type" content="article"><meta property="og:title" content="Play With Pillow"><meta property="og:description" content="Focuses on doing some useful stuff using Pillow(Python Image Library ext) for Image Processing. For example Image Cropping, resizing, Pasting image over image etc."><meta name=twitter:image content="https://ruddra.com/content/images/2019/08/pillow.jpg"><meta property="og:image" content="https://ruddra.com/content/images/2019/08/pillow.jpg"><meta property="article:tag" content="python"><meta property="article:tag" content="pil"><meta property="article:tag" content="ruddra"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"posts","mainEntityOfPage":"https:\/\/ruddra.com\/posts\/play-with-pillow\/","identifier":"https:\/\/ruddra.com\/posts\/play-with-pillow\/","author":{"@type":"Person","name":"Arnab Kumar Shil","url":"https:\/\/ruddra.com/info/about/"},"logo":"https:\/\/ruddra.com\/favicon-32x32.png","name":"Play With Pillow","headline":"Play With Pillow","description":"Focuses on doing some useful stuff using Pillow(Python Image Library ext) for Image Processing. For example Image Cropping, resizing, Pasting image over image etc.","inLanguage":"en-US","creator":["Arnab Kumar Shil"],"accountablePerson":"Arnab Kumar Shil","copyrightHolder":"Arnab Kumar Shil","copyrightYear":"2017","dateCreated":"2017-05-28T00:00:00.00Z","datePublished":"2017-05-28T00:00:00.00Z","dateModified":"2020-01-20T00:00:00.00Z","url":"https:\/\/ruddra.com\/posts\/play-with-pillow\/","wordCount":"971","publisher":{"@type":"Organization","name":"Ruddra.com | Blog by Arnab Kumar Shil","url":"https:\/\/ruddra.com","logo":"https:\/\/ruddra.com\/avatar.png"},"image":["https:\/\/ruddra.com\/content\/images\/2019\/08\/pillow.jpg"],"keywords":["Tag:Python","Tag:PIL","Elevated:true","Tag:Blog"]}</script></head><body><input type=checkbox class=sidebar-checkbox id=sidebar-checkbox><div class=sidebar id=sidebar><div class=sidebar-item><img src=/avatar.jpg><p>Hi! I am Arnab, a full stack developer specializing in <b><a href=/tags/python/>Python</a></b>,
<b><a href=/tags/django/>Django</a></b>, <b><a href=/tags/docker/>Docker</a></b>, <b><a href=/tags/reactjs/>React</a></b>, <b><a href=/tags/openshift/>OpenShift</a></b>.</p><p class=sidebar-icons><a class=icon-side-bar href=https://stackoverflow.com/users/2696165/ruddra target=_blank rel="noopener me" title=stackoverflow><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="10 10 100 100" fill="currentcolor" class="feather"><path d="M84.4 93.8V70.6h7.7v30.9H22.6V70.6h7.7v23.2z"/><path d="M38.8 68.4l37.8 7.9 1.6-7.6-37.8-7.9-1.6 7.6zm5-18 35 16.3 3.2-7-35-16.4-3.2 7.1zm9.7-17.2 29.7 24.7 4.9-5.9-29.7-24.7-4.9 5.9zm19.2-18.3-6.2 4.6 23 31 6.2-4.6-23-31zM38 86h38.6v-7.7H38V86z"/></svg></a><a class=icon-side-bar href=https://github.com/ruddra target=_blank rel="noopener me" title=github><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a class=icon-side-bar href=https://www.linkedin.com/in/ruddraarnab target=_blank rel="noopener me" title=linkedin><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-linkedin"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a><a class=icon-side-bar href=https://medium.com/@ruddra target=_blank rel="noopener me" title=medium><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd"><rect id="backgroundrect" width="100%" height="100%" x="0" y="0" fill="none" stroke="none"/><g class="currentLayer"><title>Layer 1</title><path d="M2.846 6.887c.03-.295-.083-.586-.303-.784l-2.24-2.7v-.403h6.958l5.378 11.795 4.728-11.795h6.633v.403l-1.916 1.837c-.165.126-.247.333-.213.538v13.498c-.034.204.048.411.213.537l1.871 1.837v.403h-9.412v-.403l1.939-1.882c.19-.19.19-.246.19-.537v-10.91l-5.389 13.688h-.728l-6.275-13.688v9.174c-.052.385.076.774.347 1.052l2.521 3.058v.404h-7.148v-.404l2.521-3.058c.27-.279.39-.67.325-1.052v-10.608z" id="svg_1" class="selected" opacity="1" fill="#fff" fill-opacity="1"/></g></svg></a><a class=icon-side-bar href=/posts/index.xml target=_blank rel="noopener me" title=rss><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></p></div><nav class=sidebar-nav><a class=sidebar-nav-item href=/>Home</a>
<a class=sidebar-nav-item href=/info/about/>About
Me</a>
<a class=sidebar-nav-item href=/info/privacy/>Privacy Policy</a><form class="sidebar-nav-item search-form" method=get action=/search><input type=text class=tftextinput name=q size=21 maxlength=120><button type=submit class=tfbutton><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="rgb(155,155,155)"><path d="M9.145 18.29c-5.042.0-9.145-4.102-9.145-9.145S4.103.0 9.145.0s9.145 4.103 9.145 9.145-4.102 9.145-9.145 9.145zm0-15.167c-3.321.0-6.022 2.702-6.022 6.022s2.702 6.022 6.022 6.022 6.023-2.702 6.023-6.022-2.702-6.022-6.023-6.022zm9.263 12.443c-.817 1.176-1.852 2.188-3.046 2.981l5.452 5.453 3.014-3.013-5.42-5.421z"/></svg></button></form></nav><div class=sidebar-item><p>&copy; 2020. All rights reserved.</p></div></div><div id=snackbar>By using our website, you agree to our <a href=/privacy>privacy policy</a> <a id=close-privacy>&#x2715;</a></div><div class=wrap><div class=masthead><div class=container><h3 class=masthead-title><a href=/ title=Home style=color:#cfcdcd>Ruddra</a><small style=color:#838383;font-size:1.25rem>.com</small></h3><form class="masthead-search-form pull-right" method=get action=/search><input type=text class=tftextinput name=q size=21 maxlength=120><button type=submit class=tfbutton><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="rgb(155,155,155)"><path d="M9.145 18.29c-5.042.0-9.145-4.102-9.145-9.145S4.103.0 9.145.0s9.145 4.103 9.145 9.145-4.102 9.145-9.145 9.145zm0-15.167c-3.321.0-6.022 2.702-6.022 6.022s2.702 6.022 6.022 6.022 6.023-2.702 6.023-6.022-2.702-6.022-6.023-6.022zm9.263 12.443c-.817 1.176-1.852 2.188-3.046 2.981l5.452 5.453 3.014-3.013-5.42-5.421z"/></svg></button></form></div></div><div class=progress-container><div class=progress-bar id=myBar></div></div><div class="container content"><div class=post><h1 class=post-title>Play With Pillow</h1><span class=post-date>May 28, 2017 &#183; 5 min read &#183;
1 comment</span><div class=img-container><img class=img-center src=https://ruddra.com/content/images/2019/08/pillow.jpg alt="Play With Pillow"></div><p>Who hasn&rsquo;t heard PIL? It&rsquo;s an image processing library made by python (Python Image Library). Pillow is an extension of it.<div class=toc><h2 class=toc>Table of contents</h2><nav id=TableOfContents><ul><li><a href=#installation>Installation</a></li><li><a href=#resize-image>Resize image</a></li><li><a href=#crop-image-in-box-shape>Crop image in box shape</a></li><li><a href=#resize-image-and-crop-in-center-to-convert-it-to-a-fixed-size>Resize image and crop in center to convert it to a fixed size</a></li><li><a href=#paste-image-over-a-background-image>Paste image over a background image</a></li><li><a href=#draw-text-over-an-image>Draw text over an image</a></li><li><a href=#adjast-brightness-of-an-image>Adjast brightness of an image</a></li><li><a href=#adjast-color-of-an-image>Adjast color of an image</a></li><li><a href=#save-the-pil-image-in-django-models-or-serve-as-django-file>Save the PIL image in django models or serve as django file</a></li><li><a href=#convert-to-webp>Convert to webp</a></li><li><a href=#convert-to-jpgjpeg>Convert to JPG/JPEG</a></li><li><a href=#and-many-more>And Many more</a></li></ul></nav></div><div></p><h2 id=installation>Installation<a href=#installation class=hanchor arialabel=Anchor> <svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>&#xFE0E;</a></h2><p>So installing pillow is really easy:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>pip install pillow
</code></pre></div><p>Now we are going to do some image processing cool stuff:</p><p>First Load Image:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span><span class=p>,</span> <span class=n>ImageOps</span>

<span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=sa></span><span class=s1>&#39;</span><span class=s1>image.png</span><span class=s1>&#39;</span><span class=p>)</span>
</code></pre></div><h2 id=resize-image>Resize image<a href=#resize-image class=hanchor arialabel=Anchor> <svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>&#xFE0E;</a></h2><p>Suppose We want to resize an image and maintain its aspect ratio. Here we need to get the aspect ratio after resizing. Here is a snippet for it:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>get_resize_image_size</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>baseheight</span><span class=o>=</span><span class=bp>None</span><span class=p>)</span><span class=p>:</span>
    <span class=sa></span><span class=s2>&#34;&#34;&#34;</span><span class=s2>
</span><span class=s2></span><span class=s2>    Get resize image size</span><span class=s2>
</span><span class=s2></span><span class=s2>    </span><span class=s2>&#34;&#34;&#34;</span>
    <span class=n>size</span> <span class=o>=</span> <span class=mi>1200</span><span class=p>,</span> <span class=mi>1200</span>
    <span class=k>print</span><span class=p>(</span><span class=sa></span><span class=s2>&#34;</span><span class=s2>Getting resize image size</span><span class=s2>&#34;</span><span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>baseheight</span><span class=p>:</span>
        <span class=n>baseheight</span> <span class=o>=</span> <span class=n>size</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
    <span class=n>hpercent</span> <span class=o>=</span> <span class=p>(</span><span class=n>baseheight</span> <span class=o>/</span> <span class=nb>float</span><span class=p>(</span><span class=n>image</span><span class=o>.</span><span class=n>size</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=p>)</span><span class=p>)</span>
    <span class=n>wsize</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=p>(</span><span class=nb>float</span><span class=p>(</span><span class=n>image</span><span class=o>.</span><span class=n>size</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=p>)</span> <span class=o>*</span> <span class=nb>float</span><span class=p>(</span><span class=n>hpercent</span><span class=p>)</span><span class=p>)</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>wsize</span><span class=p>,</span> <span class=n>baseheight</span>
</code></pre></div><p><strong>Or</strong> we may want to our desired image size.</p><p>After we get the desired aspect ratio, now we resize it with the following code:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>resize_image</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=bp>None</span><span class=p>)</span><span class=p>:</span>
    <span class=sa></span><span class=s2>&#34;&#34;&#34;</span><span class=s2>
</span><span class=s2></span><span class=s2>    Resize Image</span><span class=s2>
</span><span class=s2></span><span class=s2>    img: Image file opened by PIL</span><span class=s2>
</span><span class=s2></span><span class=s2>    size: if Size not given, it will be</span><span class=s2>
</span><span class=s2></span><span class=s2>    calculated</span><span class=s2>
</span><span class=s2></span><span class=s2>    </span><span class=s2>&#34;&#34;&#34;</span>
    <span class=k>print</span><span class=p>(</span><span class=sa></span><span class=s2>&#34;</span><span class=s2>Resizing image</span><span class=s2>&#34;</span><span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>size</span><span class=p>:</span>
       <span class=n>size</span> <span class=o>=</span> <span class=n>get_resize_image_size</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
    <span class=n>img</span> <span class=o>=</span> <span class=n>img</span><span class=o>.</span><span class=n>resize</span><span class=p>(</span><span class=n>size</span><span class=p>,</span> <span class=n>Image</span><span class=o>.</span><span class=n>ANTIALIAS</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>img</span>
</code></pre></div><h2 id=crop-image-in-box-shape>Crop image in box shape<a href=#crop-image-in-box-shape class=hanchor arialabel=Anchor> <svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>&#xFE0E;</a></h2><p>When we try to crop, we can either give it positions for cropping or we can calculate the points, which will be used in cropping. Suppose we have a random image, but we want to crop it in middle position and we want to crop in such way that, we will only take out 1200x1200 size out of the sample image, the following is the code:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>crop_position</span><span class=p>(</span><span class=n>image</span><span class=p>)</span><span class=p>:</span>
    <span class=sa></span><span class=s2>&#34;&#34;&#34;</span><span class=s2>
</span><span class=s2></span><span class=s2>    Get Crop Image Positions</span><span class=s2>
</span><span class=s2></span><span class=s2>    </span><span class=s2>&#34;&#34;&#34;</span>
    <span class=k>print</span><span class=p>(</span><span class=sa></span><span class=s2>&#34;</span><span class=s2>Getting Crop Image Positions</span><span class=s2>&#34;</span><span class=p>)</span>
    <span class=n>width</span><span class=p>,</span> <span class=n>height</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>size</span>
    <span class=n>new_width</span><span class=p>,</span> <span class=n>new_height</span> <span class=o>=</span> <span class=mi>1200</span><span class=p>,</span> <span class=mi>1200</span>
    <span class=n>left</span> <span class=o>=</span> <span class=p>(</span><span class=n>width</span> <span class=o>-</span> <span class=n>new_width</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span>
    <span class=n>top</span> <span class=o>=</span> <span class=p>(</span><span class=n>height</span> <span class=o>-</span> <span class=n>new_height</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span>
    <span class=n>right</span> <span class=o>=</span> <span class=p>(</span><span class=n>width</span> <span class=o>+</span> <span class=n>new_width</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span>
    <span class=n>bottom</span> <span class=o>=</span> <span class=p>(</span><span class=n>height</span> <span class=o>+</span> <span class=n>new_height</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span>
    <span class=k>return</span> <span class=n>left</span><span class=p>,</span> <span class=n>top</span><span class=p>,</span> <span class=n>right</span><span class=p>,</span> <span class=n>bottom</span>
</code></pre></div><p>Now we got the position, lets do cropping:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>crop_image</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>positions</span><span class=o>=</span><span class=bp>None</span><span class=p>)</span><span class=p>:</span>
   <span class=sa></span><span class=s2>&#34;&#34;&#34;</span><span class=s2>
</span><span class=s2></span><span class=s2>   Crop Image in Box Shape</span><span class=s2>
</span><span class=s2></span><span class=s2>   </span><span class=s2>&#34;&#34;&#34;</span>
   <span class=k>if</span> <span class=ow>not</span> <span class=n>positions</span><span class=p>:</span>
       <span class=n>positions</span> <span class=o>=</span> <span class=n>crop_position</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
   <span class=k>return</span> <span class=n>img</span><span class=o>.</span><span class=n>crop</span><span class=p>(</span><span class=n>box</span><span class=o>=</span><span class=n>positions</span><span class=p>)</span>
</code></pre></div><h2 id=resize-image-and-crop-in-center-to-convert-it-to-a-fixed-size>Resize image and crop in center to convert it to a fixed size<a href=#resize-image-and-crop-in-center-to-convert-it-to-a-fixed-size class=hanchor arialabel=Anchor> <svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>&#xFE0E;</a></h2><p>Let&rsquo;s take an image in size and convert it to 1200x1200 image:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>convert_image</span><span class=p>(</span><span class=n>pil_image</span><span class=p>)</span><span class=p>:</span>
    <span class=sa></span><span class=s2>&#34;&#34;&#34;</span><span class=s2>
</span><span class=s2></span><span class=s2>    Resize Image and Crop in Center to Convert it to a Fixed Size</span><span class=s2>
</span><span class=s2></span><span class=s2>    </span><span class=s2>&#34;&#34;&#34;</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>pil_image</span><span class=o>.</span><span class=n>size</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>size</span><span class=p>:</span>
            <span class=k>print</span><span class=p>(</span><span class=sa></span><span class=s2>&#34;</span><span class=s2>Nothing to change, returning image</span><span class=s2>&#34;</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>image</span>
        <span class=c1># Resize to size given in settings</span>
        <span class=n>pil_image</span> <span class=o>=</span> <span class=n>resize_image</span><span class=p>(</span><span class=n>pil_image</span><span class=p>)</span>
        <span class=c1># Cropping to adjust size given in settings</span>
        <span class=n>pil_image</span> <span class=o>=</span> <span class=n>crop_image</span><span class=p>(</span><span class=n>pil_image</span><span class=p>)</span>
        <span class=n>pil_image</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
    <span class=k>except</span> <span class=p>(</span><span class=ne>KeyError</span><span class=p>,</span> <span class=ne>Exception</span><span class=p>)</span> <span class=k>as</span> <span class=n>exp</span><span class=p>:</span>
        <span class=k>print</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>exp</span><span class=p>)</span><span class=p>)</span>
        <span class=k>raise</span> <span class=n>exp</span>
</code></pre></div><h2 id=paste-image-over-a-background-image>Paste image over a background image<a href=#paste-image-over-a-background-image class=hanchor arialabel=Anchor> <svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>&#xFE0E;</a></h2><p>The following code will do the trick:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>add_overlay_over_background</span><span class=p>(</span><span class=n>background_image</span><span class=p>,</span> <span class=n>overlay_image</span><span class=p>,</span> <span class=n>offset</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span><span class=p>)</span><span class=p>:</span>
    <span class=sa></span><span class=s2>&#34;&#34;&#34;</span><span class=s2>
</span><span class=s2></span><span class=s2>    Add overlay image over background image</span><span class=s2>
</span><span class=s2></span><span class=s2>    </span><span class=s2>&#34;&#34;&#34;</span>
    <span class=n>background_image</span><span class=o>.</span><span class=n>paste</span><span class=p>(</span><span class=n>overlay_image</span><span class=p>,</span> <span class=n>offset</span><span class=p>,</span> <span class=n>mask</span><span class=o>=</span><span class=n>overlay_image</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>background_image</span>
</code></pre></div><h2 id=draw-text-over-an-image>Draw text over an image<a href=#draw-text-over-an-image class=hanchor arialabel=Anchor> <svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>&#xFE0E;</a></h2><p>For that, we first we need fonts:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>path</span> <span class=o>=</span> <span class=sa></span><span class=s1>&#39;</span><span class=s1>path/to/font</span><span class=s1>&#39;</span>
<span class=k>def</span> <span class=nf>get_font</span><span class=p>(</span><span class=n>size</span><span class=p>)</span><span class=p>:</span>
    <span class=sa></span><span class=s2>&#34;&#34;&#34;</span><span class=s2>
</span><span class=s2></span><span class=s2>    Get Font Object</span><span class=s2>
</span><span class=s2></span><span class=s2>    </span><span class=s2>&#34;&#34;&#34;</span>
    <span class=k>return</span> <span class=n>ImageFont</span><span class=o>.</span><span class=n>truetype</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=n>size</span><span class=p>)</span>
</code></pre></div><p>Then we need to co-ordinates where the texts will be written:</p><p>Here are two scenarios:</p><ol><li>You provide the exact positions.</li><li>You can provide the height of the text position, we will calculate where the texts will be printed in the image. Here we are assuming that texts will be aligned in middle horizontally. It will be symmetric in perspective middle vertical line.</li></ol><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>process_text_coordination</span><span class=p>(</span><span class=n>position</span><span class=p>,</span> <span class=n>font</span><span class=o>=</span><span class=bp>None</span><span class=p>,</span> <span class=n>vertical_only</span><span class=o>=</span><span class=bp>False</span><span class=p>,</span> <span class=n>text</span><span class=o>=</span><span class=bp>None</span><span class=p>)</span><span class=p>:</span>
    <span class=sa></span><span class=s2>&#34;&#34;&#34;</span><span class=s2>
</span><span class=s2></span><span class=s2>    Process Co-Ordination of the position</span><span class=s2>
</span><span class=s2></span><span class=s2>    </span><span class=s2>&#34;&#34;&#34;</span>
    <span class=k>if</span> <span class=n>vertical_only</span><span class=p>:</span>
        <span class=c1># Case Two</span>
        <span class=n>size</span> <span class=o>=</span> <span class=n>font</span><span class=o>.</span><span class=n>getsize</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
        <span class=n>width</span> <span class=o>=</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>size</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=n>size</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span>
        <span class=k>return</span> <span class=n>width</span><span class=p>,</span> <span class=n>position</span>
    <span class=c1># Case One</span>
    <span class=k>return</span> <span class=n>position</span>
</code></pre></div><p>Now we got everything, so let&rsquo;s do writing text on image:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>write_text_on_image</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>font</span><span class=p>,</span> <span class=n>text</span><span class=p>,</span><span class=n>position</span><span class=p>,</span> <span class=n>color</span><span class=p>,</span> <span class=n>size</span><span class=p>,</span> <span class=n>vertical_only</span><span class=o>=</span><span class=bp>False</span><span class=p>)</span><span class=p>:</span>
    <span class=sa></span><span class=s2>&#34;&#34;&#34;</span><span class=s2>
</span><span class=s2></span><span class=s2>    Write Text over Image</span><span class=s2>
</span><span class=s2></span><span class=s2>    </span><span class=s2>&#34;&#34;&#34;</span>
    <span class=n>draw</span> <span class=o>=</span> <span class=n>ImageDraw</span><span class=o>.</span><span class=n>Draw</span><span class=p>(</span><span class=n>image</span><span class=p>)</span>
    <span class=n>font</span> <span class=o>=</span> <span class=n>get_font</span><span class=p>(</span><span class=n>size</span><span class=p>)</span>
    <span class=n>position</span> <span class=o>=</span> <span class=n>process_text_coordination</span><span class=p>(</span>
        <span class=n>position</span><span class=p>,</span> <span class=n>font</span><span class=p>,</span> <span class=n>vertical_only</span><span class=p>,</span> <span class=n>text</span>
    <span class=p>)</span>
    <span class=n>draw</span><span class=o>.</span><span class=n>text</span><span class=p>(</span><span class=n>position</span><span class=p>,</span> <span class=n>text</span><span class=p>,</span> <span class=n>font</span><span class=o>=</span><span class=n>font</span><span class=p>,</span> <span class=n>fill</span><span class=o>=</span><span class=n>color</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>image</span>
</code></pre></div><p>BTW, here color can be hexa value of the color you want to use. For white, you need use: <code>#fffff</code></p><h2 id=adjast-brightness-of-an-image>Adjast brightness of an image<a href=#adjast-brightness-of-an-image class=hanchor arialabel=Anchor> <svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>&#xFE0E;</a></h2><p>Let&rsquo;s lighten or darken image based on amount:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>darken_or_lighten_pixels</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>amount</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span><span class=p>:</span>
    <span class=sa></span><span class=s2>&#34;&#34;&#34;</span><span class=s2>
</span><span class=s2></span><span class=s2>    Enhance Image</span><span class=s2>
</span><span class=s2></span><span class=s2>    </span><span class=s2>&#34;&#34;&#34;</span>
    <span class=n>converter</span> <span class=o>=</span> <span class=n>ImageEnhance</span><span class=o>.</span><span class=n>Brightness</span><span class=p>(</span><span class=n>image</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>converter</span><span class=o>.</span><span class=n>enhance</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span>
</code></pre></div><h2 id=adjast-color-of-an-image>Adjast color of an image<a href=#adjast-color-of-an-image class=hanchor arialabel=Anchor> <svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>&#xFE0E;</a></h2><p>Let&rsquo;s adjust color of image based on amount</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>add_color_saturation</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>amount</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span><span class=p>:</span>
    <span class=sa></span><span class=s2>&#34;&#34;&#34;</span><span class=s2>
</span><span class=s2></span><span class=s2>    Color saturation</span><span class=s2>
</span><span class=s2></span><span class=s2>    </span><span class=s2>&#34;&#34;&#34;</span>
    <span class=n>converter</span> <span class=o>=</span> <span class=n>ImageEnhance</span><span class=o>.</span><span class=n>Color</span><span class=p>(</span><span class=n>image</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>converter</span><span class=o>.</span><span class=n>enhance</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span>
</code></pre></div><h2 id=save-the-pil-image-in-django-models-or-serve-as-django-file>Save the PIL image in django models or serve as django file<a href=#save-the-pil-image-in-django-models-or-serve-as-django-file class=hanchor arialabel=Anchor> <svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>&#xFE0E;</a></h2><p>This code will convert PIL Images to Content file:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>process_django_file</span><span class=p>(</span><span class=n>pil_image</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>format</span><span class=o>=</span><span class=sa></span><span class=s1>&#39;</span><span class=s1>png</span><span class=s1>&#39;</span><span class=p>)</span><span class=p>:</span>
    <span class=sa></span><span class=s2>&#34;&#34;&#34;</span><span class=s2>
</span><span class=s2></span><span class=s2>    Process the PIL file to Django File</span><span class=s2>
</span><span class=s2></span><span class=s2>    </span><span class=s2>&#34;&#34;&#34;</span>
    <span class=n>file_object</span> <span class=o>=</span> <span class=n>BytesIO</span><span class=p>(</span><span class=p>)</span>
    <span class=n>pil_image</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>file_object</span><span class=p>,</span> <span class=n>format</span><span class=o>=</span><span class=n>format</span><span class=p>)</span>
    <span class=n>content</span> <span class=o>=</span> <span class=n>file_object</span><span class=o>.</span><span class=n>getvalue</span><span class=p>(</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>ContentFile</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=n>name</span><span class=p>)</span>
</code></pre></div><p>And saving image will be damn easy:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>pil_image</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=sa></span><span class=s1>&#39;</span><span class=s1>image.png</span><span class=s1>&#39;</span><span class=p>)</span>

<span class=n>content_file</span> <span class=o>=</span> <span class=n>process_django_file</span><span class=p>(</span><span class=n>pil_image</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=sa></span><span class=s2>&#34;</span><span class=s2>some name</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>format</span><span class=o>=</span><span class=sa></span><span class=s1>&#39;</span><span class=s1>png</span><span class=s1>&#39;</span><span class=p>)</span>

<span class=n>my_model</span><span class=o>.</span><span class=n>image</span> <span class=o>=</span> <span class=n>content_file</span>
<span class=n>my_model</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=p>)</span>
</code></pre></div><p>Put watermark on your image by <code>PILService</code> object&rsquo;s <code>water_mark_on_image</code> method:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>img</span><span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=sa></span><span class=s1>&#39;</span><span class=s1>foobar.jpg</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=n>pil_service</span> <span class=o>=</span> <span class=n>PILService</span><span class=p>(</span><span class=p>)</span>
<span class=n>pil_service</span><span class=o>.</span><span class=n>water_mark_on_image</span><span class=p>(</span>
    <span class=n>img</span><span class=p>,</span>
    <span class=sa></span><span class=s2>&#34;</span><span class=s2>Text</span><span class=s2>&#34;</span><span class=p>,</span>
    <span class=sa></span><span class=s2>&#34;</span><span class=s2>20</span><span class=s2>&#34;</span><span class=p>,</span> <span class=c1># percent of height</span>
    <span class=sa></span><span class=s2>&#34;</span><span class=s2>font/path</span><span class=s2>&#34;</span><span class=p>,</span>
    <span class=n>opacity</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
    <span class=n>margin</span><span class=o>=</span><span class=mi>10</span>
<span class=p>)</span>
</code></pre></div><h2 id=convert-to-webp>Convert to webp<a href=#convert-to-webp class=hanchor arialabel=Anchor> <svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>&#xFE0E;</a></h2><p>For this feature you need to install.jpg driver in your machine. For mac use you need to run the following(using homebrew):</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>brew install webp
</code></pre></div><p>Or you can install <code>libwebp</code> in Unix/Linux.</p><p>Then you need to re-install pillow. Now, run this command to convert all the files to <code>*.webp</code> format in a certain directory.</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>DIR</span> <span class=o>=</span> <span class=sa></span><span class=s2>&#34;</span><span class=s2>Path/To/Images</span><span class=s2>&#34;</span>

<span class=k>for</span> <span class=n>root</span><span class=p>,</span> <span class=n>dirs</span><span class=p>,</span> <span class=n>files</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>walk</span><span class=p>(</span><span class=n>DIR</span><span class=p>)</span><span class=p>:</span>
    <span class=k>for</span> <span class=nb>file</span> <span class=ow>in</span> <span class=n>files</span><span class=p>:</span>
        <span class=n>infile</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>root</span><span class=p>,</span> <span class=nb>file</span><span class=p>)</span>
        <span class=n>name</span><span class=p>,</span> <span class=n>ext</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>splitext</span><span class=p>(</span><span class=nb>file</span><span class=p>)</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>im</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>infile</span><span class=p>)</span>
            <span class=n>im</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>root</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span> <span class=o>+</span> <span class=sa></span><span class=s2>&#34;</span><span class=s2>.webp</span><span class=s2>&#34;</span><span class=p>,</span> <span class=sa></span><span class=s2>&#34;</span><span class=s2>WEBP</span><span class=s2>&#34;</span><span class=p>)</span>
            <span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>infile</span><span class=p>)</span>  <span class=c1># comment out this line if you want to keep original images</span>
        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=k>print</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</code></pre></div><h2 id=convert-to-jpgjpeg>Convert to JPG/JPEG<a href=#convert-to-jpgjpeg class=hanchor arialabel=Anchor> <svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>&#xFE0E;</a></h2><p>Before converting to JPG/JPEG, you need to know that JPG is a lossy compression, and it can&rsquo;t convert RGBA(Red, Green, Blue, Alpha). Meaning it can&rsquo;t convert Alpha. So you can try like this:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>im</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>infile</span><span class=p>)</span>
<span class=n>im</span> <span class=o>=</span> <span class=n>im</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=sa></span><span class=s1>&#39;</span><span class=s1>RGB</span><span class=s1>&#39;</span><span class=p>)</span>  <span class=c1># convert RGB</span>
<span class=n>im</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>root</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span> <span class=o>+</span> <span class=sa></span><span class=s2>&#34;</span><span class=s2>.jpg</span><span class=s2>&#34;</span><span class=p>,</span> <span class=sa></span><span class=s2>&#34;</span><span class=s2>JPEG</span><span class=s2>&#34;</span><span class=p>)</span>
</code></pre></div><p>But above code will convert any transparent background to black. So instead you can use a white background to replace transparent part and then convert to RGB:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>im</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>infile</span><span class=p>)</span>
<span class=n>new_image</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=sa></span><span class=s2>&#34;</span><span class=s2>RGBA</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>im</span><span class=o>.</span><span class=n>size</span><span class=p>,</span> <span class=sa></span><span class=s2>&#34;</span><span class=s2>WHITE</span><span class=s2>&#34;</span><span class=p>)</span>  <span class=c1># White Image</span>
<span class=n>new_image</span><span class=o>.</span><span class=n>paste</span><span class=p>(</span><span class=n>im</span><span class=p>,</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span><span class=p>,</span> <span class=n>im</span><span class=p>)</span>  <span class=c1># Setting as background</span>
<span class=n>im</span> <span class=o>=</span> <span class=n>new_image</span><span class=o>.</span><span class=n>convert</span><span class=p>(</span><span class=sa></span><span class=s1>&#39;</span><span class=s1>RGB</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=n>im</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>root</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span> <span class=o>+</span> <span class=sa></span><span class=s2>&#34;</span><span class=s2>.jpg</span><span class=s2>&#34;</span><span class=p>,</span> <span class=sa></span><span class=s2>&#34;</span><span class=s2>JPEG</span><span class=s2>&#34;</span><span class=p>)</span>
</code></pre></div><h2 id=and-many-more>And Many more<a href=#and-many-more class=hanchor arialabel=Anchor> <svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>&#xFE0E;</a></h2><p>Many more methods are given in this Repo: <a href=https://github.com/ruddra/play-with-pillow>https://github.com/ruddra/play-with-pillow</a></p><p>Hope it was helpful. Cheers!!!</p></div><br><p><a class=tag-class href=/tags/python>Python</a> <a class=tag-class href=/tags/pil>PIL</a></p><div class=newsletter-section><h2>Get Better With Python</h2><div id=commento class="commento-root commento-root-font"><div id=newsletter-error class=commento-error-box style=display:none>An error occurred when submitting the form, please try again.</div><div id=newsletter-submitted style=display:none><b>Thank you for your subscription to newsletters.<br>You will start recieving emails from next iteration.</b><br><br></div><div id=newsletter-body><div>Subscribe to get monthly articles about Python and more.<br>We won't spam you. Unsubscribe at any time.</div><br><div id=commento-main-area class=commento-main-area><form id=comment-form method=post action=https://ruddra-comments.herokuapp.com/v2/entry/ruddra/ruddra.comments/master/comments><input type=hidden name=options[redirect] value=https://ruddra.com/posts/play-with-pillow/#newsletter-submitted>
<input type=hidden name=options[slug] value=newsletter-subscription>
<input type=hidden name=options[parent] value=newsletter-subscription>
<input type=hidden name=options[origin] value=https://ruddra.com/newsletters/>
<input type=hidden name=options[redirectError] value=https://ruddra.com/posts/play-with-pillow/#newsletter-error><div id=commento-login class=commento-login><input type=email name=fields[email] placeholder="Your email address" style="padding-left:10px;width:90%;line-height:2;border:1px solid rgba(50,50,93,.1)" required></div><div style=width:95.8%><button id=commento-submit-button-root type=submit class="commento-button commento-submit-button">Subscribe</button><div class="commento-round-check commento-anonymous-checkbox-container"><input id=commento-checkbox-root name=options[subscribe] type=checkbox value=email required><label for=commento-checkbox-root>I agree to receive
emails</label></div></div></form></div></div></div></div><script>if(window.location.hash=="#newsletter-submitted"){var $comTarget=document.getElementById('newsletter-submitted');$comTarget.style.display='block';var $comTarget=document.getElementById('newsletter-body');$comTarget.style.display='none';}else if(window.location.hash=="#newsletter-error"){var $comTarget=document.getElementById('newsletter-error');$comTarget.style.display='block';}</script><div class=pagination><div class="pagination-item older"><span class=pagination-arrow>&#8592; Previous</span><div class=pagination-link><a href=https://ruddra.com/posts/python-selenium-with-phantomjs-to-capture-screenshots/>Python: Selenium with PhantomJs to capture Screenshots</a></div><div class=pagination-image><img src=https://ruddra.com/content/images/2019/02/pycharm.jpg alt="Python: Selenium with PhantomJs to capture Screenshots"></div><p class=pagination-text>PhantomJS is a headless WebKit scriptable with a JavaScript API. It has fast and native support for various web …</p></div><div class="pagination-item newer"><span class=pagination-arrow>Next &#8594;</span><div class=pagination-link><a href=https://ruddra.com/posts/ubuntu-protip-launching-chrome-apps-at-startup/>Ubuntu Hacks: Launching Chrome Apps at Startup</a></div><div class=pagination-image><img src=https://ruddra.com/content/images/2020/03/ball.jpg alt="Ubuntu Hacks: Launching Chrome Apps at Startup"></div><p class=pagination-text>Chrome apps are really handy when you don&rsquo;t want to overhaul your system with apps for every little purpose. …</p></div></div><div class=tiny><div id=commento class="commento-root commento-root-font"><div id=comment-submitted style=display:none><h3><i>Thank you for your comment. It will be published once approved.</i></h3><br></div><div id=comment-error class=commento-error-box style=display:none>An error occurred when submitting the form, please try again.</div><div id=commento-mod-tools class=commento-mod-tools style=display:none><button id=commento-mod-tools-lock-button>Lock Thread</button></div><div id=commento-main-area class=commento-main-area><form id=comment-form method=post action=https://ruddra-comments.herokuapp.com/v2/entry/ruddra/ruddra.comments/master/comments><input type=hidden name=options[redirect] value=https://ruddra.com/posts/play-with-pillow/#comment-submitted>
<input type=hidden name=options[slug] value=play-with-pillow>
<input type=hidden name=options[parent] value=play-with-pillow>
<input type=hidden name=options[origin] value=https://ruddra.com/posts/play-with-pillow/>
<input type=hidden id=comment-parent name=fields[reply_to]>
<input type=hidden name=options[redirectError] value=https://ruddra.com/posts/play-with-pillow/#comment-error><div id=commento-logged-container class=commento-logged-container><div class=commento-name id=comment-headline><b>Share Your Thoughts</b></div></div><div class=commento-logout></div></div><div id=commento-login class=commento-login><input type=txt name=fields[name] placeholder=Name style="padding-left:10px;width:100%;line-height:2;border:1px solid rgba(50,50,93,.1);margin-bottom:5px;border-radius:2px" required>
<input type=email name=fields[email] placeholder="Email(will not be shared publicly)" style="padding-left:10px;width:100%;line-height:2;border:1px solid rgba(50,50,93,.1);border-radius:2px" required></div><div id=commento-textarea-super-container-root class=commento-button-margin><div id=commento-textarea-container-root class=commento-textarea-container><textarea name=fields[comment] id=commento-textarea-root placeholder="Add a comment" onchange=renderCommentInMD(this.value) onkeyup=this.onchange(); onpaste=this.onchange(); oninput=this.onchange(); required></textarea></div><button id=commento-submit-button-root type=submit class="commento-button commento-submit-button">Add
Comment</button><div class="commento-round-check commento-anonymous-checkbox-container"><input id=commento-anonymous-checkbox-root name=options[subscribe] type=checkbox value=email><label for=commento-anonymous-checkbox-root>Notify me of new comments</label></div><a id=commento-markdown-button-root class=commento-markdown-button><b>M ↓</b> &nbsp; Markdown</a></div><p id=commneto-renderer-msg></p></form><div id=commento-comments-area class=commento-comments><div id=commento-comment-card-1520668757 style="border-left:2px solid #c6fe02" class=commento-card><div class=commento-header><div id=commento-comment-options-1520668757 class=commento-options><button id=commento-comment-reply-1520668757 href=#comment-form onclick="changeValue('fields[reply_to]','1520668757','haseeb ahmed')" title="Reply to haseeb ahmed" class="commento-option-button commento-option-reply onhover" style=right:0></button></div><img src="https://www.gravatar.com/avatar/577f60f34863203db01ccdb78cc6fe02?s=70&r=pg&d=identicon" class=commento-avatar-img><div id=commento-comment-name-1520668757 class=commento-name>haseeb ahmed</div><div id=commento-comment-subtitle-1520668757 class=commento-subtitle><div id=commento-comment-timeago-1520668757 title="Saturday, Mar 10, 2018" class=commento-timeago>Saturday, Mar 10, 2018</div></div></div><div id=commento-comment-contents-1520668757><div id=commento-comment-body-1520668757 class=commento-body><div id=commento-comment-text-1520668757><p>this is awesomeness, thanks. referrring to this SOF thread > <a href=https://stackoverflow.com/q..>https://stackoverflow.com/q..</a>. could you please psudo code an example. where multiple operations can be done on images collection (list) (resize, brightness etc) before stacking. thanks in advance. actually in my case, thumbnail method instead of resizing doesn&rsquo;t work.</p></div></div></div><div></div><script>function changeValue(elementName,newValue,name){document.getElementsByName(elementName)[0].value=newValue;document.getElementById('comment-headline').innerHTML="<b>Reply To: "+name+"</b>";window.location.hash="#comment-form";};</script></div></div></div></div><script>if(window.location.hash=="#comment-submitted"){var $comTarget=document.getElementById('comment-submitted');$comTarget.style.display='block';}else if(window.location.hash=="#comment-error"){var $comTarget=document.getElementById('comment-error');$comTarget.style.display='block';}
function renderCommentInMD(inputVal){var converter=new showdown.Converter();document.getElementById('commneto-renderer-msg').innerHTML=`<h2 class="commneto-renderer-msg-header" style="color:rgb(128, 9, 9); font-weight:800;font-size:20px">&nbspPreview:</h2>`+converter.makeHtml(inputVal);document.getElementById('commento-textarea-root').innerHTML=inputVal}
window.onscroll=function(){scrollProgressFunc()};function scrollProgressFunc(){var elmnt=document.getElementsByClassName("post");var winScroll=elmnt.scrollTop||document.documentElement.scrollTop;var height=document.documentElement.scrollHeight-document.documentElement.clientHeight;var scrolled=(winScroll/height)*100;document.getElementById("myBar").style.width=scrolled+"%";}</script></div></div><script src=https://ruddra.com/js/bundle.min.js async></script></div></div><label for=sidebar-checkbox class=sidebar-toggle></label><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-58095062-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body><script>function showPrivacy(){if(localStorage.getItem("cookieSeen")!="shown"){var x=document.getElementById("snackbar");x.className="show";localStorage.setItem("cookieSeen","shown")}}
showPrivacy();function closePrivacy(){var fadeTarget=document.getElementById("snackbar");var fadeEffect=setInterval(function(){if(!fadeTarget.style.opacity){fadeTarget.style.opacity=1;}
if(fadeTarget.style.opacity>0){fadeTarget.style.opacity-=0.1;}else{clearInterval(fadeEffect);}},50);}
document.getElementById("close-privacy").addEventListener('click',closePrivacy);</script></html>